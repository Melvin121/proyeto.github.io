(this.webpackJsonpproyectoapi=this.webpackJsonpproyectoapi||[]).push([[0],{33:function(e,t,c){},62:function(e,t,c){"use strict";c.r(t);var a=c(0),s=c.n(a),n=c(26),r=c.n(n),l=(c(33),c(16)),o=c(2),i=c(3),u=c.n(i),p=c(5),x=c(6),j=c.n(x),d=c.p+"static/media/man.ba422ca1.png",m=c(1),b=function(){var e=Object(o.f)(),t=Object(a.useRef)(null),c=Object(a.useRef)(null);function s(){return(s=Object(p.a)(u.a.mark((function a(s){var n,r,l,o;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s.preventDefault(),n=t.current.value,r=c.current.value,a.prev=3,a.next=6,j.a.post("https://posts-pw2021.herokuapp.com/api/v1/auth/signin",{username:n,password:r});case 6:200===(l=a.sent).status&&(localStorage.setItem("token",l.data.token),localStorage.setItem("role",l.data.role),e("/")),a.next=15;break;case 10:a.prev=10,a.t0=a.catch(3),o=a.t0.response,"",401===o.status?"Revise sus datos":500===o.status?"Error de servidor":404===o.status&&"No se encontro el usuario";case 15:case"end":return a.stop()}}),a,null,[[3,10]])})))).apply(this,arguments)}return Object(m.jsxs)("form",{className:"flex justify-center flex-col bg-gray-900 items-center min-h-screen ",onSubmit:function(e){return s.apply(this,arguments)},children:[Object(m.jsx)("h1",{className:"text-white text-6xl",children:" Login "}),Object(m.jsx)("img",{src:d,className:"w-1/6 m-6"}),Object(m.jsxs)("div",{className:"flex-col",children:[Object(m.jsx)("label",{htmlFor:"L-user",className:"text-white flex justify-center",children:"User"}),Object(m.jsx)("input",{id:"L-user",type:"text",ref:t,className:"rounded border"})]}),Object(m.jsxs)("div",{className:"",children:[Object(m.jsx)("label",{htmlFor:"L-password",className:"text-white flex justify-center",children:"Password"}),Object(m.jsx)("input",{id:"L-password",type:"password",ref:c,className:"rounded border"})]}),Object(m.jsx)("div",{className:"flex space-y-2",children:Object(m.jsx)("button",{className:"bg-white border rounded-2xl m-3 w-full py-2 px-8 ",children:"Login "})})]})},f=c(4),h=function(){return Object(m.jsxs)("div",{className:"absolute top-0 left-0 z-20 bg-white h-screen w-screen flex justify-center items-center flex-col",children:[Object(m.jsx)("img",{src:"http://www.bobesponjaweb.com/wp-content/uploads/2014/11/18.jpg",className:"bg-gradient-to-t"}),Object(m.jsx)("div",{class:"absolute w-full py-3.5 text-white text-5xl text-center leading-4 overflow-y-hidden",children:"HANG ON ;)"})]})},O=c(17),g=c(28),y=c(27),v=c.n(y),w=c(9),N=function(e){var t=e.info,c=t.description,a=t.user;return Object(m.jsxs)("div",{className:"w-full border-t my-3",children:[Object(m.jsxs)("h1",{className:"mt-2 text-sm font-medium text-purple-800",children:["@",null===a||void 0===a?void 0:a.username]}),Object(m.jsx)("p",{className:"text-xs pl-4",children:c})]})},k=function(e){var t=e.post,c=e.afterSubmit,s=Object(a.useState)(""),n=Object(f.a)(s,2),r=n[0],l=n[1];function o(){return(o=Object(p.a)(u.a.mark((function e(a){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),s={description:r},console.log(t),e.next=5,j.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/comment/".concat(t),s,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 5:l(""),c(s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.jsx)("form",{className:"w-full",onSubmit:function(e){return o.apply(this,arguments)},children:Object(m.jsx)("input",{value:r,onChange:function(e){l(e.target.value)},className:"px-4 py-2 w-full rounded-2xl text-gray-800 border-2 border-blue-500 text-xs",type:"text",placeholder:"Presiona enter para comentar"})})},S=function(e){var t=e.id,c=Object(a.useRef)(null),s=Object(a.useRef)(null),n=Object(a.useRef)(null);function r(){return(r=Object(p.a)(u.a.mark((function e(a){var r,l,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),r=c.current.value,l=s.current.value,o=n.current.value,""!==l||""!==r||""!==o){e.next=6;break}return e.abrupt("return",alert("Llena el titulo y la descripcion"));case 6:return console.log(l),e.next=9,j.a.put("https://posts-pw2021.herokuapp.com/api/v1/post/update/".concat(t),{title:r,description:l,image:o},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 9:e.sent;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.jsxs)("form",{id:"form",onSubmit:function(e){return r.apply(this,arguments)},className:"bg-white bg-opacity-30 mt-4 rounded-2xl p-4 text-white font-bold space-y-3",children:[Object(m.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(m.jsx)("label",{htmlFor:"title",children:"Titulo"}),Object(m.jsx)("input",{className:"text-gray-800 rounded-full px-2 py-1 my-1",type:"text",name:"title",id:"title",ref:c})]}),Object(m.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(m.jsx)("label",{htmlFor:"description",children:"Descripcion"}),Object(m.jsx)("input",{className:"text-gray-800 rounded-full px-2 py-1 my-1",type:"text",name:"description",id:"description",ref:s})]}),Object(m.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(m.jsx)("label",{htmlFor:"image",children:"Imagen"}),Object(m.jsx)("input",{className:"text-gray-800 rounded-full px-2 py-1 my-1",type:"text",name:"image",id:"image",ref:n})]}),Object(m.jsx)("div",{className:"flex flex-row text-sm items-center justify-center",children:Object(m.jsxs)("button",{type:"submit",className:"bg-blue-500 w-2/3 rounded-2xl text-center flex py-1 justify-center items-center font-bold",children:[Object(m.jsx)(w.b,{className:"mr-2 h-5 w-5"}),"Editar"]})})]})},I=function(e){var t=e.username,c=e.struct,s=c._id,n=c.title,r=c.description,l=c.image,o=c.user,i=c.createdAt,x=c.likes,d=c.comments,b=Object(a.useState)(!1),h=Object(f.a)(b,2),y=h[0],I=h[1],F=Object(a.useState)(!1),L=Object(f.a)(F,2),D=L[0],A=L[1],B=Object(a.useState)(d),C=Object(f.a)(B,2),z=C[0],E=C[1],P=Object(a.useState)(x.some((function(e){return e.username===t}))),R=Object(f.a)(P,2),T=R[0],G=R[1],J=Object(a.useState)(x.length),_=Object(f.a)(J,2),H=_[0],M=_[1],U=localStorage.getItem("role");function q(){return(q=Object(p.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=j.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/like/".concat(s),null,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t.data,T?(M(H-1),G(!1)):(M(H+1),G(!0))}catch(c){console.log(c)}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(p.a)(u.a.mark((function e(){var t,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=j.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/toggle/".concat(s),null,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),c=t.data,console.log(c)}catch(a){console.log(a)}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.jsxs)("div",{className:"flex flex-col space-evenly rounded-2xl p-4 w-1/4 text-white justify-evenly",children:[Object(m.jsxs)("div",{className:"w-full flex flex-col font-bold text-white overflow-x-auto justify-evenly",children:[Object(m.jsxs)("h1",{className:"w-1/2",children:["@",null===o||void 0===o?void 0:o.username]}),Object(m.jsx)("h2",{className:"text-right w-1/2",children:new Date(i).toLocaleDateString()})]}),l&&Object(m.jsx)("img",{className:"w-min h-min object-cover my-2 rounded-2xl",src:l,alt:"No se pudo cargar la imagen"}),"admin"===U&&Object(m.jsxs)("div",{className:"flex flex-col justify-evenly text-purple-800",children:[y&&Object(m.jsx)(S,{id:s}),Object(m.jsx)("button",{onClick:function(){return I(!y)},children:"Editar"}),Object(m.jsx)("button",{onClick:function(){return K.apply(this,arguments)},children:"Ocultar"})]}),Object(m.jsxs)("div",{className:"w-full flex flex-col font-medium text-sm space-y-2, overflow-x-auto overflow-y-auto",children:[Object(m.jsx)("h1",{className:"",children:n}),Object(m.jsx)("h2",{className:"font-normal text-xs",children:r})]}),Object(m.jsxs)("div",{className:"w-full mt-4 flex justify-center",children:[Object(m.jsxs)("button",{onClick:function(){return q.apply(this,arguments)},type:"button",className:"flex space-x-2 text-xs justify-center items-center w-1/2 ".concat(T&&"text-purple-800"),children:[Object(m.jsx)("span",{children:Object(m.jsx)(w.c,{className:"mr-2 w-5 h-5 mx-0"})}),H]}),Object(m.jsxs)("button",{onClick:function(){return A(!D)},type:"button",className:"flex space-x-2 text-xs justify-center items-center w-1/2 ".concat(D&&"text-purple-800"),children:[Object(m.jsx)("span",{children:Object(m.jsx)(w.a,{className:"mr-2 w-5 h-5 mx-0"})}),z.length]})]}),Object(m.jsxs)("div",{className:"".concat(!D&&"hidden"," mt-4 w-full flex flex-col items-start"),children:[d&&z.map((function(e){return Object(m.jsx)(N,{info:e},v.a.generate())})),Object(m.jsx)(k,{post:s,afterSubmit:function(e){var c=[].concat(Object(g.a)(z),[Object(O.a)(Object(O.a)({},e),{},{user:{username:t.username}})]);E(c)}})]})]})},F=function(e){var t=Object(a.useState)({status:"LOADING",data:{}}),c=Object(f.a)(t,2),s=c[0],n=c[1],r=localStorage.getItem("token");return console.log(r),Object(a.useEffect)((function(){function e(){return(e=Object(p.a)(u.a.mark((function e(){var t,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("https://posts-pw2021.herokuapp.com/api/v1/post/all?limit=666&page=0",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:t=e.sent,c=t.data,n({status:"Done",data:c.data});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),"LOADING"===s.status?Object(m.jsx)(h,{}):(console.log(s),Object(m.jsx)("div",{className:"flex flex-wrap px-6 mt-2 justify-center items-center",children:s.data&&s.data.map((function(t){return Object(m.jsx)(I,{username:e,struct:t},t._id)}))}))},L=function(){function e(){return(e=Object(p.a)(u.a.mark((function e(t){var c,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c=new FormData(t.target),""!==(a=Object.fromEntries(c.entries())).title&&""!==a.description){e.next=5;break}return e.abrupt("return",alert("Llena el titulo y la descripcion"));case 5:return e.next=7,j.a.post("https://posts-pw2021.herokuapp.com/api/v1/post/create",{title:a.title,description:a.description,image:a.image},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 7:s=e.sent,console.log(s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.jsxs)("form",{id:"form",onSubmit:function(t){return e.apply(this,arguments)},className:"bg-white bg-opacity-30 mt-4 rounded-2xl p-4 text-white font-bold space-y-3",children:[Object(m.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(m.jsx)("label",{htmlFor:"title",children:"Titulo"}),Object(m.jsx)("input",{className:"text-gray-800 rounded-full px-2 py-1 my-1",type:"text",name:"title",id:"title"})]}),Object(m.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(m.jsx)("label",{htmlFor:"description",children:"Descripcion"}),Object(m.jsx)("input",{className:"text-gray-800 rounded-full px-2 py-1 my-1",type:"text",name:"description",id:"description"})]}),Object(m.jsxs)("div",{className:"flex flex-col text-sm",children:[Object(m.jsx)("label",{htmlFor:"image",children:"Imagen"}),Object(m.jsx)("input",{className:"text-gray-800 rounded-full px-2 py-1 my-1",type:"text",name:"image",id:"image"})]}),Object(m.jsxs)("div",{className:"flex flex-row text-sm items-center justify-center",children:[Object(m.jsxs)("div",{className:"flex text-sm w-1/3",children:[Object(m.jsx)("label",{htmlFor:"active",children:"Activo"}),Object(m.jsx)("input",{className:"rounded-lg text-blue-500 w-5 h-5 mx-2 focus:ring-blue-400 focus:ring-opacity-25 border border-gray-300",type:"checkbox",name:"active",id:"active"})]}),Object(m.jsxs)("button",{type:"submit",className:"bg-blue-500 w-2/3 rounded-2xl text-center flex py-1 justify-center items-center font-bold",children:[Object(m.jsx)(w.b,{className:"mr-2 h-5 w-5"}),"Publicar"]})]})]})},D=function(){var e=Object(a.useState)(!1),t=Object(f.a)(e,2),c=t[0],s=t[1];return Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{className:"px-8",children:[c&&Object(m.jsx)(L,{}),Object(m.jsx)("button",{onClick:function(){return s(!c)},type:"button",className:"w-1/4 bg-white \r text-center rounded-2xl flex text-black hover:bg-purple-900 hover:text-white  justify-center mt-3 py-4 \r ",children:"Publicar :)"})]}),")"]})},A=function(){var e=Object(a.useState)(),t=Object(f.a)(e,2),c=t[0],s=t[1],n=Object(o.f)(),r=localStorage.getItem("token"),l=localStorage.getItem("role");return Object(a.useEffect)((function(){function e(){return(e=Object(p.a)(u.a.mark((function e(){var t,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("https://posts-pw2021.herokuapp.com/api/v1/auth/whoami",{headers:{Authorization:"Bearer ".concat(r)}});case 2:t=e.sent,c=t.data,s(c.username);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=r?function(){e.apply(this,arguments)}():n("/login")}),[]),Object(m.jsxs)("div",{children:["admin"===l&&Object(m.jsx)(D,{}),Object(m.jsx)(F,{username:c})]})},B=function(){return Object(m.jsx)(l.a,{children:Object(m.jsxs)(o.c,{children:[Object(m.jsx)(o.a,{path:"/",element:Object(m.jsx)(A,{})}),Object(m.jsx)(o.a,{path:"/Login",element:Object(m.jsx)(b,{})})]})})},C=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,63)).then((function(t){var c=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,r=t.getTTFB;c(e),a(e),s(e),n(e),r(e)}))};r.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(B,{})}),document.getElementById("root")),C()}},[[62,1,2]]]);
//# sourceMappingURL=main.1a10bc10.chunk.js.map